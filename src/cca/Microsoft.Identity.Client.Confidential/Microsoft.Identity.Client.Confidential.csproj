<Project Sdk="MSBuild.Sdk.Extras">

  <PropertyGroup>
    <TargetFrameworkNetDesktop>net45</TargetFrameworkNetDesktop> 
    <TargetFrameworkNetStandard>netstandard1.3</TargetFrameworkNetStandard>
    <TargetFrameworkNetCore>netcoreapp2.1</TargetFrameworkNetCore>

    <TargetFrameworks Condition="$([MSBuild]::IsOsPlatform('Windows'))">$(TargetFrameworkNetDesktop);$(TargetFrameworkNetStandard);$(TargetFrameworkNetCore);</TargetFrameworks>
    <TargetFrameworks Condition="!$([MSBuild]::IsOsPlatform('Windows'))">$(TargetFrameworkNetStandard);$(TargetFrameworkNetCore);</TargetFrameworks>

    <PathToSources>$(MSBuildThisFileDirectory)</PathToSources>
  </PropertyGroup>

  <PropertyGroup Label="NuGet and AssemblyInfo metadata">
    <Title>Microsoft Authentication Library for .NET - Confidential Clients</Title>
    <Description>
      This package contains the binaries of the Microsoft Authentication Library for .NET (MSAL.NET), for Web Apps, Web APIs and daemons. For mobile apps, GUI and CLI apps, use Microsoft.Identity.Client.Public
      MSAL.NET makes it easy to obtain tokens from the Microsoft identity platform for developers (formally Azure AD v2.0) signing-in users with work &amp; school accounts, Microsoft personal accounts and social identities Azure AD B2C. These tokens again access to Microsoft Cloud API and any other API secured by the Microsoft identity platform. This version supports adding authentication functionality to your .NET based client on Windows desktop (.NET 4.5+), UWP, .NET Core, Xamarin iOS and Xamarin Android.
    </Description>
    <PackageTags>Microsoft Authentication Library MSA MSAL B2C Azure Active Directory AAD Identity Authentication .NET Windows Store Xamarin iOS Android</PackageTags>
  </PropertyGroup>

  <Import Project="..\..\ConstantsForLibAssemblies.props" />

  <!-- TODO: analyze this-->
  
  <ItemGroup>
    <!-- This None is here so the conditionally included files show up in the Solution Explorer -->
    <None Include="$(PathToSources)\**\*.cs;$(PathToSources)\**\*.xml;$(PathToSources)\**\*.axml" Exclude="$(PathToSources)\obj\**\*.*;$(PathToSources)\bin\**\*.*" />
    <!-- Manually include the cs files -->
    <Compile Include="$(PathToSources)\**\*.cs" Exclude="$(PathToSources)\obj\**\*.*" />
    <Compile Remove="$(PathToSources)\Platforms\**\*.*;$(PathToSources)\Resources\*.cs" />    
  </ItemGroup>

  <ItemGroup Condition="'$(TargetFramework)' == '$(TargetFrameworkNetStandard)'">
    <Compile Include="$(PathToSources)\Platforms\netstandard13\**\*.cs" LinkBase="Platforms\netstandard13" />
    <Compile Include="$(PathToSources)\Platforms\Shared\NetStdCore\**\*.cs" />

    <PackageReference Include="System.Runtime.Serialization.Primitives" Version="4.3.0" />
    <PackageReference Include="System.Runtime.Serialization.Json" Version="4.3.0" />
    <PackageReference Include="System.Xml.XDocument" Version="4.3.0" />
    <PackageReference Include="System.Security.Cryptography.X509Certificates" Version="4.3.0" />
    <PackageReference Include="System.Dynamic.Runtime" Version="4.3.0" />
    <PackageReference Include="Microsoft.CSharp" Version="4.5.0" />
    <PackageReference Include="System.Runtime.Serialization.Formatters" Version="4.3.0" />
    <PackageReference Include="System.Xml.XmlDocument" Version="4.3.0" />
    <PackageReference Include="System.ComponentModel.TypeConverter" Version="4.3.0" />
    <PackageReference Include="System.Security.SecureString" Version="4.3.0" />
    <PackageReference Include="System.Diagnostics.Process" Version="4.3.0" />
    <!-- 4.3.0 has CVE-2019-0657 -->
    <PackageReference Include="System.Private.Uri" Version="4.3.2" />
  </ItemGroup>

  <ItemGroup Condition=" '$(TargetFramework)' == '$(TargetFrameworkNetCore)' ">
    <Compile Include="$(PathToSources)\Platforms\netcore\**\*.cs" LinkBase="Platforms\netcore" />

    <PackageReference Include="System.ComponentModel.TypeConverter" Version="4.3.0" />
    <PackageReference Include="System.Runtime.Serialization.Primitives" Version="4.3.0" />
    <PackageReference Include="System.Runtime.Serialization.Formatters" Version="4.3.0" />
    <PackageReference Include="System.Runtime.Serialization.Json" Version="4.3.0" />
    <PackageReference Include="System.Xml.XDocument" Version="4.3.0" />
    <PackageReference Include="System.Net.NameResolution" Version="4.3.0" />
    <PackageReference Include="Microsoft.CSharp" Version="4.5.0" />
    <PackageReference Include="System.Security.SecureString" Version="4.3.0" />
    <!-- 4.3.0 has CVE-2019-0657 -->
    <PackageReference Include="System.Private.Uri" Version="4.3.2" />
  </ItemGroup>
  <ItemGroup Condition=" '$(TargetFramework)' == '$(TargetFrameworkNetDesktop)' ">
    <Compile Include="$(PathToSources)\Platforms\net45\**\*.cs" LinkBase="Platforms\net45" />
    <Reference Include="System" />
    <Reference Include="System.Core" />    
    <Reference Include="System.IdentityModel" />
    <Reference Include="System.Net.Http" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Xml" />
  </ItemGroup>
  
  <ItemGroup>
    <ProjectReference Include="..\..\shared\Microsoft.Identity.Client.Shared\Microsoft.Identity.Client.Shared.csproj" />
  </ItemGroup>


</Project>
